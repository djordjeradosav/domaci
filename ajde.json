{
  "info": {
    "name": "Laravel Client Invoice API",
    "description": "Kompletna kolekcija za testiranje Laravel API-ja sa autentifikacijom",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8000/api",
      "description": "Base URL za API"
    },
    {
      "key": "token",
      "value": "",
      "description": "Bearer token za autentifikaciju"
    },
    {
      "key": "admin_token",
      "value": "",
      "description": "Admin Bearer token"
    },
    {
      "key": "client_id",
      "value": "",
      "description": "ID kreiranog klijenta"
    },
    {
      "key": "invoice_id",
      "value": "",
      "description": "ID kreirane fakture"
    },
    {
      "key": "contact_id",
      "value": "",
      "description": "ID kreiranog kontakta"
    },
    {
      "key": "user_id",
      "value": "",
      "description": "ID korisnika"
    }
  ],
  "item": [
    {
      "name": "01 - Autentifikacija",
      "item": [
        {
          "name": "Registracija Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Admin User\",\n    \"email\": \"admin@test.com\",\n    \"password\": \"password123\",\n    \"password_confirmation\": \"password123\",\n    \"role\": \"admin\",\n    \"company\": \"Admin Company\",\n    \"phone\": \"+381123456789\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/register",
              "host": ["{{baseUrl}}"],
              "path": ["register"]
            },
            "description": "Registruj admin korisnika"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('admin_token', response.token);",
                  "    pm.environment.set('user_id', response.user.id);",
                  "    console.log('Admin token saved:', response.token);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Registracija User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Regular User\",\n    \"email\": \"user@test.com\",\n    \"password\": \"password123\",\n    \"password_confirmation\": \"password123\",\n    \"role\": \"user\",\n    \"company\": \"User Company\",\n    \"phone\": \"+381987654321\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/register",
              "host": ["{{baseUrl}}"],
              "path": ["register"]
            }
          }
        },
        {
          "name": "Registracija Client",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Client User\",\n    \"email\": \"client@test.com\",\n    \"password\": \"password123\",\n    \"password_confirmation\": \"password123\",\n    \"role\": \"client\",\n    \"company\": \"Client Company\",\n    \"phone\": \"+381555666777\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/register",
              "host": ["{{baseUrl}}"],
              "path": ["register"]
            }
          }
        },
        {
          "name": "Login Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"admin@test.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/login",
              "host": ["{{baseUrl}}"],
              "path": ["login"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('admin_token', response.token);",
                  "    pm.environment.set('token', response.token);",
                  "    console.log('Token saved:', response.token);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Login User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"user@test.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/login",
              "host": ["{{baseUrl}}"],
              "path": ["login"]
            }
          }
        },
        {
          "name": "Get Current User",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/user",
              "host": ["{{baseUrl}}"],
              "path": ["user"]
            }
          }
        },
        {
          "name": "Reset Password",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"current_password\": \"password123\",\n    \"new_password\": \"newpassword123\",\n    \"new_password_confirmation\": \"newpassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/reset-password",
              "host": ["{{baseUrl}}"],
              "path": ["reset-password"]
            }
          }
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/logout",
              "host": ["{{baseUrl}}"],
              "path": ["logout"]
            }
          }
        }
      ]
    },
    {
      "name": "02 - Clients",
      "item": [
        {
          "name": "Get All Clients",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/clients",
              "host": ["{{baseUrl}}"],
              "path": ["clients"]
            }
          }
        },
        {
          "name": "Create Client (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Test Client\",\n    \"email\": \"testclient@example.com\",\n    \"phone\": \"+381123456789\",\n    \"company\": \"Test Company Ltd\",\n    \"address\": \"Test Address 123, Belgrade, Serbia\",\n    \"status\": \"Active\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/clients",
              "host": ["{{baseUrl}}"],
              "path": ["clients"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('client_id', response.client.id);",
                  "    console.log('Client ID saved:', response.client.id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Single Client",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/clients/{{client_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["clients", "{{client_id}}"]
            }
          }
        },
        {
          "name": "Update Client",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Updated Test Client\",\n    \"email\": \"testclient@example.com\",\n    \"phone\": \"+381123456789\",\n    \"company\": \"Updated Company Ltd\",\n    \"address\": \"Updated Address 456, Belgrade, Serbia\",\n    \"status\": \"Active\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/clients/{{client_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["clients", "{{client_id}}"]
            }
          }
        },
        {
          "name": "Delete Client (Admin Only)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/clients/{{client_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["clients", "{{client_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "03 - Contacts",
      "item": [
        {
          "name": "Get All Contacts",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/contacts",
              "host": ["{{baseUrl}}"],
              "path": ["contacts"]
            }
          }
        },
        {
          "name": "Create Contact",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"client_id\": {{client_id}},\n    \"contact_name\": \"John Doe\",\n    \"contact_email\": \"john.doe@testclient.com\",\n    \"contact_phone\": \"+381987654321\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/contacts",
              "host": ["{{baseUrl}}"],
              "path": ["contacts"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('contact_id', response.contact.id);",
                  "    console.log('Contact ID saved:', response.contact.id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Single Contact",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/contacts/{{contact_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["contacts", "{{contact_id}}"]
            }
          }
        },
        {
          "name": "Update Contact",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"contact_name\": \"John Updated Doe\",\n    \"contact_email\": \"john.updated@testclient.com\",\n    \"contact_phone\": \"+381987654322\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/contacts/{{contact_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["contacts", "{{contact_id}}"]
            }
          }
        },
        {
          "name": "Delete Contact",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/contacts/{{contact_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["contacts", "{{contact_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "04 - Invoices",
      "item": [
        {
          "name": "Get All Invoices",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices",
              "host": ["{{baseUrl}}"],
              "path": ["invoices"]
            }
          }
        },
        {
          "name": "Create Invoice (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"client_id\": {{client_id}},\n    \"amount\": 1000.00,\n    \"tax_amount\": 200.00,\n    \"issue_date\": \"2024-12-01\",\n    \"due_date\": \"2024-12-31\",\n    \"notes\": \"Test invoice for services\",\n    \"status\": \"Draft\",\n    \"items\": [\n        {\n            \"description\": \"Web Development\",\n            \"quantity\": 10,\n            \"rate\": 100.00,\n            \"amount\": 1000.00\n        }\n    ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invoices",
              "host": ["{{baseUrl}}"],
              "path": ["invoices"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('invoice_id', response.id);",
                  "    console.log('Invoice ID saved:', response.id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Single Invoice",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoice_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["invoices", "{{invoice_id}}"]
            }
          }
        },
        {
          "name": "Update Invoice",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"client_id\": {{client_id}},\n    \"amount\": 1500.00,\n    \"tax_amount\": 300.00,\n    \"issue_date\": \"2024-12-01\",\n    \"due_date\": \"2024-12-31\",\n    \"notes\": \"Updated invoice for services\",\n    \"status\": \"Sent\",\n    \"items\": [\n        {\n            \"description\": \"Web Development + Design\",\n            \"quantity\": 15,\n            \"rate\": 100.00,\n            \"amount\": 1500.00\n        }\n    ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoice_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["invoices", "{{invoice_id}}"]
            }
          }
        },
        {
          "name": "Delete Invoice (Admin Only)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invoices/{{invoice_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["invoices", "{{invoice_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "05 - Admin Only Routes",
      "item": [
        {
          "name": "Get All Users (Admin)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users",
              "host": ["{{baseUrl}}"],
              "path": ["users"]
            }
          }
        },
        {
          "name": "Get Single User (Admin)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users/{{user_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["users", "{{user_id}}"]
            }
          }
        },
        {
          "name": "Update User (Admin)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Updated Admin User\",\n    \"email\": \"admin@test.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users/{{user_id}}",
              "host": ["{{baseUrl}}"],
              "path": ["users", "{{user_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "06 - Error Testing",
      "item": [
        {
          "name": "Unauthorized Access (No Token)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/clients",
              "host": ["{{baseUrl}}"],
              "path": ["clients"]
            }
          }
        },
        {
          "name": "User Try to Create Client (Should Fail)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Should Fail Client\",\n    \"email\": \"shouldfail@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/clients",
              "host": ["{{baseUrl}}"],
              "path": ["clients"]
            }
          }
        },
        {
          "name": "Invalid Login Credentials",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"wrong@email.com\",\n    \"password\": \"wrongpassword\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/login",
              "host": ["{{baseUrl}}"],
              "path": ["login"]
            }
          }
        }
      ]
    }
  ]
}
